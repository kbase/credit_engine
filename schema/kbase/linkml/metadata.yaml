# yaml-language-server: $schema=https://linkml.io/linkml-model/linkml_model/jsonschema/meta.schema.json
id: https://github.com/kbase/credit_engine/schema/kbase/linkml/
name: credit_metadata
description: Schema for KBase resource credit metadata
version: 0.0.1
prefixes:
  bioportal: https://bioportal.bioontology.org/ontologies/
  biolink: https://w3id.org/biolink/vocab/
  CRediT: https://credit.niso.org/contributor-roles/
  Crossref: https://crossref.org/
  DataCite: https://purl.org/datacite/v4.4/
  DOI: http://identifiers.org/doi/
  gdmt: http://vocab.fairdatacollective.org/fdc-gdmt/en/page/
  JGI: https://data.jgi.doe.gov/search/
  linkml: https://w3id.org/linkml/
  ORCID: http://identifiers.org/orcid/
  OSTI: https://www.osti.gov/biblio/
  ROR: https://ror.org/
  rdfs: http://www.w3.org/2000/01/rdf-schema#
  schema: http://schema.org/
imports:
  - linkml:types
default_range: string

classes:

  CreditMetadataEntry:
    description: Container for an instance of credit metadata; includes the credit metadata itself and metadata for the credit metadata.

    attributes:
      credit_metadata:
        description: the credit metadata itself
        required: true
        range: CreditMetadata

      credit_metadata_schema_version:
        description: the version of the credit metadata schema used
        required: true
        examples:
          - value: 1.1.0

      saved_by:
        description: KBase workspace ID of the user who added this entry
        required: true

      timestamp:
        description: unix timestamp for the addition of this set of credit metadata
        required: true
        range: integer


  CreditMetadata:
    description: |
      Represents the credit metadata associated with a workspace object.

      In the following documentation, 'Resource' is used to refer to the workspace object
      that the CM pertains to.

      The 'resource_type' field should be filled using values from the DataCite
      resourceTypeGeneral field:

      https://support.datacite.org/docs/datacite-metadata-schema-v44-mandatory-properties#10a-resourcetypegeneral

      Currently the KBase workspace only supports credit metadata for objects of type
      'dataset'; anything else will return an error.

      The license may be supplied either as an URL pointing to licensing information for
      the resource, or using a license name. See https://choosealicense.com/appendix/ for
      a list of common open source licenses.

      Required fields are:
      - identifier
      - versioning information: if the resource does not have an explicit version number,
      one or more dates should be supplied: ideally the date of resource publication and
      the last update (if applicable).
      - contributors (one or more required)
      - titles (one or more required)

      The resource_type field is required, but as there is currently only a single valid
      value, 'dataset', it is automatically populated if no value is supplied.

    attributes:

      comment:
        description: list of strings of freeform text providing extra information about this credit metadata.
        inlined_as_list: true
        multivalued: true
        examples:
        - value:
          - ["Credit metadata generated automatically from DOI:10.13039/100000015"]

      identifier:
        description: resolvable persistent unique identifier for the resource. Should be in the format <database name>:<identifier within database>.
        range: uriorcurie
        required: true
        pattern: "^[a-zA-Z0-9.]+:\\S"
        examples:
        - value: RefSeq:GCF_004214875.1
        - value: GenBank:CP035949.1
        - value: img.taxon:648028003
        exact_mappings:
        - DataCite:id
          # from: DataCite:id
          # via: "DOI:{DataCite:id}"
        - OSTI:osti_id
          # from: OSTI:osti_id
          # via: "OSTI:{OSTI:osti_id}"
        - JGI:organisms[].grouped_by
          # from JGI:organisms[].grouped_by
          # via: JGI:organisms[].files[].{JGI:organisms[].grouped_by}

      license:
        description: usage license for the resource. May be a text string or an URL. Abbreviations should be spelled out where possible (e.g. 'Creative Commons 4.0' instead of 'CC-BY-4.0'). The license is interpreted as an URL and checked for well-formedness if it starts with a series of letters, a colon, and slashes, e.g. "http://"; "https://"; "ftp://".
        slot_uri: biolink:license
        examples:
        - value: Creative Commons 4.0
        - value: MIT
        - value: https://jgi.doe.gov/user-programs/pmo-overview/policies/
        related_mappings:
        - DataCite:attributes.rights_list

      resource_type:
        description: the broad type of the source data for this workspace object. 'dataset' is the only valid value currently.
        range: ResourceType
        required: true
        exact_mappings:
        - OSTI:product_type
        # see DataCite:attributes.types
        - DataCite:attributes.types.schema_org
        examples:
        - value: dataset

      version:
        description: the version of the resource. This must be an absolute version, not a relative version like 'latest'.
        exact_mappings:
        - DataCite:attributes.version
        examples:
        - value: '5'
        - value: 1.2.1
        - value: '20220405'

      contributors:
        description: a list of people and/or organizations who contributed to the resource.
        inlined_as_list: true
        multivalued: true
        range: Contributor
        narrow_mappings:
        - DataCite:attributes.contributors
        - DataCite:attributes.creators
        - OSTI:contributors
        - OSTI:authors
        - JGI:organisms[].pi

      dates:
        description: a list of relevant lifecycle events for the resource.
        inlined_as_list: true
        multivalued: true
        range: EventDate
        examples:
        - value: { date: 2022-05-10, event: available }
        close_mappings:
        - DataCite:attributes.published
          # from DataCite:attributes.published
          # via { date: DataCite:attributes.published, date_type: published, date_format: YYYY }
        - DataCite:attributes.updated
          # from DataCite:attributes.updated
          # via { date: DataCite:attributes.updated, date_type: updated, date_format: YYYY-MM-DDTHH:MM:SS.fffZ }
        - DataCite:attributes.dates[]
          # from DataCite:attributes.dates[]
          # via { date: DataCite:attributes.dates[].date, date_type: DataCite:attributes.dates[].dateType, date_format: YYYY }
        - OSTI:publication_date
          # from: OSTI:publication_date
          # via { date: OSTI:publication_date, date_type: published, date_format: YYYY-MM-DDTHH:MM:SSZ }
        - Crossref:message.deposited
          # from: Crossref:message.deposited
          # via { date: Crossref:message.deposited.date-time, date_type: deposited, date_format: YYYY-MM-DDTHH:MM:SS.ffZ }

      funding:
        description: funding sources for the resource.
        inlined_as_list: true
        multivalued: true
        range: FundingReference
        close_mappings:
        - DataCite:attributes.funding_references
        - Crossref:Message.project.funding

      related_identifiers:
        description: other resolvable persistent unique IDs related to the resource.
        inlined_as_list: true
        multivalued: true
        range: ResolvablePID
        close_mappings:
        - DataCite:attributes.identifiers
        - DataCite:attributes.related_identifiers
        - DataCite:attributes.alternate_identifiers
        - OSTI:related_identifiers
        - OSTI:doi
          # from: OSTI:doi
          # via: { id: "DOI:{OSTI:doi}"}

      titles:
        description: one or more titles for the resource.
        inlined_as_list: true
        multivalued: true
        range: Title
        required: true
        exact_mappings:
        - DataCite:attributes.titles[]
        - OSTI:title
          # from: OSTI:title
          # via: [OSTI:title]
        examples:
        - value: { title: Amaranthus hypochondriacus genome }
        - value: { title: Геном амаранта ипохондрического, title_type: translated_title, title_language: ru-Cyrl }


  Contributor:
    description: |
      Represents a contributor to the resource.

      Contributors must have a 'contributor_type', either 'person' or 'organization', and
      a 'name'.

      The 'credit_name' field is used to store the name of a person as it would appear in
      a citation. If there is no 'credit_name' supplied, the 'name' field would be used
      in citations.
      For example:
        name:         Hubert George Wells
        credit_name:  Wells, HG

        name:         Alexandria Ocasio-Cortez
        credit_name:  Ocasio-Cortez, A

        name:         Helena Bonham Carter
        credit_name:  Bonham Carter, H

      The 'contributor_role' field takes values from the DataCite and CRediT contributor
      roles vocabularies. For more information on these resources and choosing the
      appropriate roles, please see the following links:

      DataCite contributor roles: https://support.datacite.org/docs/datacite-metadata-schema-v44-recommended-and-optional-properties#7a-contributortype

      CRediT contributor role taxonomy: https://credit.niso.org

    attributes:
      contributor_type:
        description: must be either 'person' or 'organization'
        range: ContributorType
        examples:
        - value: person
        - value: organization
        exact_mappings:
        - DataCite:attributes.contributors[].name_type
        - DataCite:attributes.creators[].name_type

      contributor_id:
        identifier: true
        description: persistent unique identifier for the contributor; this might be an ORCID for an individual, or a ROR ID for an organization.
        range: uriorcurie
        pattern: "^[a-zA-Z0-9.]+:\\S"
        examples:
        - value: ORCID:0000-0001-9557-7715
        - value: ROR:01znn6x10
        exact_mappings:
        - DataCite:attributes.contributors[].name_identifiers[].name_identifier
        - DataCite:attributes.creators[].name_identifiers[].name_identifier
          # from: DataCite:attributes.contributors[].name_identifiers[].name_identifier_scheme == 'ORCID'
          # via: "ORCID:{ DataCite:attributes.contributors[].name_identifiers[].name_identifier.replace('https://orcid.org/', '') }"
        narrow_mappings:
        - OSTI:orcid
        - Crossref:message.project.funding.funder.name

      name:
        description: contributor name. For organizations, this should be the full (unabbreviated) name; for a person, the full name should be entered.
        examples:
          - value: Helena Bonham Carter
          - value: Hubert Wells
          - value: Madonna
          - value: Marionetta Cecille de la Carte-Postale
          - value: National Institute of Mental Health
          - value: Ransome the Clown
        required: true
        related_mappings:
        # these have the names comma-separated and inverted
        - DataCite:attributes.creators[].name
        - DataCite:attributes.contributors[].name
        exact_mappings:
        - JGI:organisms[].pi.name

      credit_name:
        description: for a person, how the name should appear in a citation.
        examples:
          - value: Carte-Postale, MC
          - value: Bonham Carter, H
          - value: Wells, HG
        exact_mappings:
          - ORCID:credit_name

      affiliations:
        description: list of organizations with which the contributor is affiliated. For contributors that represent an organization, this may be a parent organization (e.g. KBase, US DOE; Arkin lab, LBNL).
        inlined_as_list: true
        multivalued: true
        range: Organization
        related_mappings:
        - DataCite:attributes.contributors[].affiliation[]
          # from: DataCite:attributes.contributors[].affiliation[]
          # via: {
          #   organization_name: "DataCite:attributes.contributors[].affiliation[].name"
          # }
        - DataCite:attributes.creators[].affiliation[]
          # from: DataCite:attributes.creators[].affiliation[]
          # via: {
          #   organization_name: "DataCite:attributes.creators[].affiliation[].name"
          # }
        - JGI:organisms[].pi.institution
          # from: JGI:organisms[].pi.institution
          # via: {
          #   organization_name: "JGI:organisms[].pi.institution"
          #}

      contributor_roles:
        description: list of roles played by the contributor when working on the resource.
        inlined_as_list: true
        multivalued: true
        exact_mappings:
        - DataCite:attributes.contributors[].contributor_type
        - DataCite:attributes.creators[].contributor_type
        todos:
        - add DataCite and Credit roles as enums
        related_mappings:
        - JGI:organisms[].pi
        # from: JGI:organisms[].pi
        # via: "DataCite:ProjectLeader"

  EventDate:
    description: |
      Represents an event in the lifecycle of a resource and the date it occurred on.

      See https://support.datacite.org/docs/datacite-metadata-schema-v44-recommended-and-optional-properties#8-date for more information on the events.
    attributes:
      date:
        description: the date associated with the event. The date may be in the format YYYY, YYYY-MM, or YYYY-MM-DD.
        range: date_or_datetime
        required: true
        examples:
        - value: '2001'
        - value: 2021-05
        - value: 1998-02-15

      event:
        description: the nature of the resource-related event that occurred on that date
        range: EventType
        required: true
        examples:
        - value: available
        - value: updated


  FundingReference:
    description: |
      Represents a funding source for a resource, including the funding body and the grant awarded.

      The 'funder_name' field is required; all others are optional.

      Recommended resources for organization identifiers include:
        - Research Organization Registry, http://ror.org
        - International Standard Name Identifier, https://isni.org
        - Crossref Funder Registry, https://www.crossref.org/services/funder-registry/

      Some organizations may have a digital object identifier (DOI).

    attributes:
      funder_id:
        description: persistent unique identifier for the funder in the format <database name>:<identifier within database>
        exact_mappings:
        - DataCite:attributes.funding_references[].funder_identifier
        - Crossref:message.project.funding.funder.id.id
        range: uriorcurie
        pattern: "^[a-zA-Z0-9.]+:\\S"
        examples:
        - value: DOI:10.13039/100000015
        - value: ISNI:0000000405337147
        - value: ROR:04xm1d337

      funder_name:
        description: common name for the funder
        required: true
        exact_mappings:
        - DataCite:attributes.funding_references[].funder_name
        - Crossref:message.project.funding.funder.name
        - OSTI:sponsoring_organization
        examples:
        - value: Joint Genome Institute
        - value: National Science Foundation
        - value: US DOE Office of Science (SC), Biological and Environmental Research (BER)

      award_id:
        description: code for the award, assigned by the funder
        exact_mappings:
        - DataCite:attributes.funding_references[].award_number
        - Crossref:message.award
        examples:
        - value: '1296'
        - value: CBET-0756451
        - value: DOI:10.46936/10.25585/60000745

      award_title:
        description: title for the award
        exact_mappings:
        - DataCite:attributes.funding_references[].award_title
        examples:
        - value: Metagenomic analysis of the rhizosphere of three biofuel crops at the KBS intensive site

      award_url:
        description: URL for the award
        exact_mappings:
        - DataCite:attributes.funding_references[].award_url
        range: uriorcurie
        pattern: "^[a-zA-Z0-9.]+:\\S"
        examples:
        - value: https://genome.jgi.doe.gov/portal/Metanaintenssite/Metanaintenssite.info.html


  Organization:
    description: |
      Represents an organization.

      Recommended resources for organization identifiers and canonical organization names include:
        - Research Organization Registry, http://ror.org
        - International Standard Name Identifier, https://isni.org
        - Crossref Funder Registry, https://www.crossref.org/services/funder-registry/

      For example, the US DOE would be entered as:
        organization_name: United States Department of Energy
        organization_id:   ROR:01bj3aw27

    class_uri: schema:Organization

    attributes:
      organization_id:
        description: persistent unique identifier for the organization in the format <database name>:<identifier within database>
        identifier: true
        examples:
        - value: ROR:01bj3aw27
        - value: ISNI:0000000123423717
        - value: CrossrefFunder:100000015
        exact_mappings:
        - DataCite:attributes.contributors[].affiliation.affiliation_identifier
        - DataCite:attributes.creators[].affiliation.affiliation_identifier
        range: uriorcurie
        pattern: "^[a-zA-Z0-9.]+:\\S"

      organization_name:
        description: common name of the organization; use the name recommended by ROR if possible.
        required: true
        exact_mappings:
        - DataCite:attributes.contributors[].affiliation.name
        - DataCite:attributes.creators[].affiliation.name
        - OSTI:research_organization
        - JGI:organisms[].pi.institution
        examples:
        - value: KBase
        - value: Lawrence Berkeley National Laboratory
        - value: The Ohio State University


  PermanentID:
    description: |
      Represents a persistent unique identifier for an entity, with an optional relationship to some other entity.

      The 'id' field is required; all other fields are optional.

      The values in the 'relationship_type' field come from controlled vocabularies maintained by DataCite and Crossref. See the documentation links below for more details.

      DataCite relation types: https://support.datacite.org/docs/datacite-metadata-schema-v44-recommended-and-optional-properties#12b-relationtype

      Crossref relation types: https://www.crossref.org/documentation/schema-library/markup-guide-metadata-segments/relationships/

    attributes:
      id:
        identifier: true
        description: persistent unique ID for an entity. Should be in the format <database name>:<identifier within database>.
        required: true
        examples:
        - value: DOI:10.46936/10.25585/60000745
        - value: GO:0005456
        - value: HGNC:7470
        exact_mappings:
        - DataCite:attributes.identifier.value
        - DataCite:attributes.alternate_identifiers[]
          # from: DataCite:attributes.alternate_identifiers[]
          # via: "{DataCite:attributes.alternate_identifiers[].alternate_identifier_type}:{DataCite:attributes.alternate_identifiers[].alternate_identifier}"
        - DataCite:attributes.related_identifiers[]
          # from: DataCite:attributes.related_identifiers[]
          # via: "{DataCite:attributes.related_identifiers[].related_identifier_type}:{DataCite:attributes.related_identifiers[].related_identifier}"
        - DataCite:attributes.identifiers[]
          # from: DataCite:attributes.identifiers[]
          # via: "{DataCite:attributes.identifiers[].identifier_type}:{DataCite:attributes.identifiers[].identifier}"
        related_mappings:
        - OSTI:site_url
        range: uriorcurie
        pattern: "^[a-zA-Z0-9.]+:\\S"

      description:
        slot_uri: schema:description
        description: description of that entity
        exact_mappings:
        - OSTI:description
        examples:
        - value: Amaranthus hypochondriacus genome
        - value: This data analysis workflow demonstrates how to process a metagenome to identify viruses using VirSorter. Then, provides taxonomic classification using vConTACT2

      relationship_type:
        description: |
          The relationship between the ID and some other entity.
          For example, when a PermanentID class is used to represent objects in the CreditMetadata field 'related_identifiers', the 'relationship_type' field captures the relationship between the CreditMetadata and this ID.
        range: RelationshipType
        exact_mappings:
        - DataCite:attributes.related_identifiers[].relation_type


  Title:
    description: |
      Represents the title or name of a resource.

      The 'title_string' field is required; if no value is supplied for 'title_type', it
      defaults to 'title'.

      If the title is in a language other than English, the 'title_type' should be set to
      'translated_title', and the appropriate BCP-47 tag supplied in the 'title_language'
      field.

      Note that the workspace checks that the 'title_language' field adheres to IETF
      BCP-47 syntax rules, but it does not check the validity of the tag.

    attributes:
      title:
        description: a string used as a title for a resource
        required: true
        examples:
        - value: Amaranthus hypochondriacus genome
        - value: Геном амаранта ипохондрического
        exact_mappings:
        - DataCite:attributes.titles.title
        - Crossref:message.project.project-title.title

      title_type:
        description: a descriptor for the title. The default value is 'title'.
        range: TitleType
        examples:
        - value: subtitle
        - value: alternative_title
        - value: translated_title
        - value: other
        exact_mappings:
        - DataCite:attributes.title.titleType

      title_language:
        description: language that the title is in, as a IETF BCP-47 tag.
        examples:
        - value: fr
        - value: jp-JP
        - value: zh-Hant-CN
        - value: en-Latn-GB
        - value: mn-Cyrl

enums:
  ContributorType:
    description: The type of contributor being represented
    permissible_values:
      person:
        description: a person
      organization:
        description: an organization
    reachable_from:
      source_ontology: bioportal:DATACITE-VOCAB
      source_nodes:
        - DataCite:ResourceCreatorType
      include_self: false
      relationship_types:
        - rdfs:subClassOf

  ContributorRole:
    description: The type of contribution made by a contributor
    permissible_values:
      DataCite:ContactPerson:
      DataCite:DataCollector:
      DataCite:DataCurator:
      DataCite:DataManager:
      DataCite:Distributor:
      DataCite:Editor:
      DataCite:HostingInstitution:
      DataCite:Producer:
      DataCite:ProjectLeader:
      DataCite:ProjectManager:
      DataCite:ProjectMember:
      DataCite:RegistrationAgency:
      DataCite:RegistrationAuthority:
      DataCite:RelatedPerson:
      DataCite:Researcher:
      DataCite:ResearchGroup:
      DataCite:RightsHolder:
      DataCite:Sponsor:
      DataCite:Supervisor:
      DataCite:WorkPackageLeader:
      DataCite:Other:
      CRediT:conceptualization:
      CRediT:data-curation:
      CRediT:formal-analysis:
      CRediT:funding-acquisition:
      CRediT:investigation:
      CRediT:methodology:
      CRediT:project-administration:
      CRediT:resources:
      CRediT:software:
      CRediT:supervision:
      CRediT:validation:
      CRediT:visualization:
      CRediT:writing-original-draft:
      CRediT:writing-review-editing:
    reachable_from:
      source_ontology: bioportal:DATACITE-VOCAB
      source_nodes:
      - DataCite:ContributorRole
      include_self: false
      relationship_types:
        - rdfs:subClassOf


  EventType:
    description: The type of date being represented
    permissible_values:
      accepted:
      available:
      copyrighted:
      collected:
      created:
      issued:
      submitted:
      updated:
      valid:
      withdrawn:
      other:
    reachable_from:
      source_ontology: bioportal:DATACITE-VOCAB
      source_nodes:
        - DataCite:DateType
      include_self: false
      relationship_types:
        - rdfs:subClassOf

  RelationshipType:
    description: the relationship between two entities
    permissible_values:
      DataCite:Cites:
      DataCite:Compiles:
      DataCite:Continues:
      DataCite:Describes:
      DataCite:Documents:
      DataCite:HasMetadata:
      DataCite:HasPart:
      DataCite:HasVersion:
      DataCite:IsCitedBy:
      DataCite:isCompiledBy:
      DataCite:IsContinuedBy:
      DataCite:IsDerivedFrom:
      DataCite:IsDescribedBy:
      DataCite:IsDocumentedBy:
      DataCite:IsIdenticalTo:
      DataCite:IsMetadataFor:
      DataCite:IsNewVersionOf:
      DataCite:IsOriginalFormOf:
      DataCite:IsPartOf:
      DataCite:IsPreviousVersionOf:
      DataCite:IsPublishedIn:
      DataCite:IsReferencedBy:
      DataCite:IsRequiredBy:
      DataCite:IsReviewedBy:
      DataCite:IsSourceOf:
      DataCite:IsSupplementTo:
      DataCite:IsSupplementedBy:
      DataCite:IsVariantFormOf:
      DataCite:IsVersionOf:
      DataCite:Obsoletes:
      DataCite:References:
      DataCite:Requires:
      DataCite:Reviews:
      Crossref:BasedOnData:
      Crossref:Finances:
      Crossref:HasComment:
      Crossref:HasDerivation:
      Crossref:HasExpression:
      Crossref:HasFormat:
      Crossref:HasManifestation:
      Crossref:HasManuscript:
      Crossref:HasPreprint:
      Crossref:HasRelatedMaterial:
      Crossref:HasReply:
      Crossref:HasReview:
      Crossref:HasTranslation:
      Crossref:IsBasedOn:
      Crossref:IsBasisFor:
      Crossref:IsCommentOn:
      Crossref:IsDataBasisFor:
      Crossref:IsExpressionOf:
      Crossref:IsFinancedBy:
      Crossref:IsFormatOf:
      Crossref:IsManifestationOf:
      Crossref:IsManuscriptOf:
      Crossref:IsPreprintOf:
      Crossref:IsRelatedMaterial:
      Crossref:IsReplacedBy:
      Crossref:IsReplyTo:
      Crossref:IsReviewOf:
      Crossref:IsSameAs:
      Crossref:IsTranslationOf:
      Crossref:Replaces:
    reachable_from:
      source_ontology: bioportal:DATACITE-VOCAB
      source_nodes:
        - DataCite:RelationType
      include_self: false
      relationship_types:
        - rdfs:subClassOf


  ResourceType:
    description: The type of resource being represented
    permissible_values:
      dataset:
        description: a dataset

  TitleType:
    description: The type of title being represented
    permissible_values:
      title:
        description: the default title
      subtitle:
        description: any subtitle for the resource
      alternative_title:
        description: other title(s) or names for the resource
      translated_title:
        description: title_language must be specified if this value is used
      other:
        description: anything that doesn't fit into the above categories
